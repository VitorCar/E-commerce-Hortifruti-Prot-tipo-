{% extends 'base.html' %}
{% load static %}
{% load multiplication %}

{% block title %}Meu Carrinho{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/carrinho.css' %}">

<div class="carrinho-container">
  <h1>Meu Carrinho</h1>

  {% if carrinho_items %}
    <table class="carrinho-tabela">
      <thead>
        <tr>
          <th>Produto</th>
          <th>Preço</th>
          <th>Quantidade</th>
          <th>Total</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for produto_id, item in carrinho_items.items %}
          <tr>
            <td>
              <p>{{ item.nome }}</p>
              <small>({{ item.medida }})</small>
            </td>
            <td>R$ {{ item.preco|floatformat:2 }}</td>
            <td>
              <div class="quantidade-display">
                {{ item.quantidade }}
              </div>
            </td>
            <td>
              R$ {{ item.preco|multiply:item.quantidade|floatformat:2 }}
            </td>
            <td>
              <form action="{% url 'remover_do_carrinho' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="produto_id" value="{{ produto_id }}">
                <button type="submit" class="btn-remover">Remover</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="resumo-carrinho">
      <h3>Resumo do Pedido</h3>
      <p>Subtotal: R$ {{ subtotal|floatformat:2 }}</p>
    </div> <!-- Fechando resumo-carrinho -->
    
  {% else %}
    <p class="carrinho-vazio">Seu carrinho está vazio.</p>
  {% endif %}
</div>
{% endblock %}
