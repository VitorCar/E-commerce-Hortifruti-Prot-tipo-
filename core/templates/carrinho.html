{% extends 'base.html' %}
{% load static %}
{% load multiplication %}

{% block title %}Meu Carrinho{% endblock %}

{% block content %}
<style>

  .btn-produto {
    display: inline-block;
    background-color: var(--secondary-color);
    color: var(--light-text);
    padding: 12px 25px;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    transition: background-color 0.3s ease, transform 0.2s ease;
}

.btn-produto:hover {

  background-color: #689f38;
  transform: translateY(-2px);
}
</style>

<link rel="stylesheet" href="{% static 'css/carrinho.css' %}">

<div class="carrinho-container">
  <h1>Meu Carrinho</h1>

  {% if carrinho_items %}
    <table class="carrinho-tabela">
      <thead>
        <tr>
          <th>Produto</th>
          <th>Preço</th>
          <th>Quantidade</th>
          <th>Total</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for produto_id, item in carrinho_items.items %}
          <tr>
            <td>
              <p>{{ item.nome }}</p>
              <small>({{ item.medida }})</small>
            </td>
            <td>R$ {{ item.preco|floatformat:2 }}</td>
            <td>
              <div class="quantidade-display">
                {{ item.quantidade }}
              </div>
            </td>
            <td>
              R$ {{ item.preco|multiply:item.quantidade|floatformat:2 }}
            </td>
            <td>
              <form action="{% url 'remover_do_carrinho' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="produto_id" value="{{ produto_id }}">
                <button type="submit" class="btn-remover">Remover</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="resumo-carrinho">
      <h3>Resumo do Pedido</h3>
      <p>Subtotal: R$ {{ subtotal|floatformat:2 }}</p>
    </div> <!-- Fechando resumo-carrinho -->
    <a href="{% url 'fake_checkout' %}" class="btn-produto" style="margin-left:8px;">Pagamento simulado</a>

  {% else %}
    <p class="carrinho-vazio">Seu carrinho está vazio.</p>
  {% endif %}
</div>
{% endblock %}
