{% extends 'base.html' %}
{% load static %}

{% block title %}Produtos - Hortifruti{% endblock %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/produtos.css' %}">

<h1 style="text-align: center; margin-bottom: 30px;">Lista de Vegetais</h1>

<div class="search-form-container">
  <form method="GET" action="{% url 'vegetais' %}">
    <input type="text" name="search" placeholder="Buscar por nome..." value="{{ request.GET.search }}">
    <button type="submit">Buscar</button>
  </form>
</div>

<div class="produto-grid">
  {% if vegetais %}
    {% for vegetal in vegetais %}
      <div class="produto-card">
        {% if vegetal.image %}
          <img src="{{ vegetal.image.url }}" alt="{{ vegetal.name }}" class="vegetal-img">
        {% else %}
          <div style="height: 200px; background-color: #eee; display: flex; align-items: center; justify-content: center; color: #999;">
            Sem imagem
          </div>
        {% endif %}
        {% if vegetal.promocao %}
          <div class="promo-badge">Promoção</div>
        {% endif %}
        <div class="produto-card-content">
          <h3>{{ vegetal.name }}</h3>
          {% if vegetal.promocao %}
            <p class="price" style="color: red; text-decoration: line-through;">
              R$ {{ vegetal.value|floatformat:2 }}
            </p>
            <p class="price" style="color: green; font-weight: bold;">
              R$ {{ vegetal.promocao.new_value|floatformat:2 }} / {{ vegetal.medida.medida }}
            </p>
          {% else %}
            <p class="price">
              R$ {{ vegetal.value|floatformat:2 }} / {{ vegetal.medida.medida }}
            </p>
          {% endif %}
          <p>Categoria: {{ vegetal.category.name }}</p>
          <a href="{% url 'produto_detail' vegetal.pk %}" class="produto-btn">Comprar</a>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p class="no-results">Nenhum vegetal encontrado.</p>
  {% endif %}
</div>
{% endblock %}
